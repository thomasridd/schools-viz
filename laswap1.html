<!DOCTYPE html>
<html>
<meta charset="utf-8">

<!-- Example based on http://bl.ocks.org/mbostock/3887118 -->
<!-- Tooltip example from http://www.d3noob.org/2013/01/adding-tooltips-to-d3js-graph.html -->

<style>

.chord path {
  fill-opacity: .67;
  stroke: #000;
  stroke-width: .5px;
}

</style>

<!-- Included CSS Files-->
<link rel="stylesheet" href="stylesheets/style.css">
<link rel="stylesheet" href="stylesheets/skins/pink.css">
<link rel="stylesheet" href="stylesheets/responsive.css">

<body>

<!-- HEADER
================================================== -->
<div class="row">	
		<div class="four columns">
			<div class="logo">
				<a href="index.html"><h4>Schools Viz</h4></a>
			</div>
		</div>
</div>
<div class="clear">
</div>

<!-- SUBHEADER
================================================== -->
<div id="subheader">
	<div class="row">
		<div class="twelve columns">
			<p class="left">
				 Visualization Gallery
			</p>
			<p class="right">
				 <a href="tree.html">next>></a>
			</p>
		</div>
	</div>
</div>
<div class="hr">
</div>

<div class = "row">
	<div class = "panel">
		<h4>Connectivity</h4>
		<p>At LaSwap students are based at one school but can take lessons anywhere in the consortium. This chord diagram illustrates the
		amount of interaction we have by showing how each school allots teaching time to students from across the consortium.</p>
	</div>
</div>

<div id = "here"></div>

			<script src="http://d3js.org/d3.v3.min.js" type="text/javascript"></script>
			<script type="text/javascript">
				// LaSwap combination table
				var matrix = [ [ 563, 91, 126, 0, 75 ],
						[ 65, 624, 103, 0, 73 ], [ 81, 75, 497, 0, 169 ],
						[ 9, 5, 70, 0, 36 ], [ 75, 63, 192, 0, 269 ] ];

				var chord = d3.layout.chord().padding(.05).sortSubgroups(
						d3.descending).matrix(matrix);

				var width = 500, height = 500, innerRadius = Math.min(width,
						height) * .41, outerRadius = innerRadius * 1.1;

				var fill = d3.scale.ordinal().domain(d3.range(5))
						.range(
								[ "#f00055", "#009252", "#7c2479", "#000000",
										"#00aace" ]);

				var svg = d3.select("#here").append("svg").attr("width", width)
						.attr("height", height).append("g").attr(
								"transform",
								"translate(" + width / 2 + "," + height / 2
										+ ")");

				svg.append("g").selectAll("path").data(chord.groups).enter()
						.append("path").style("fill", function(d) {
							return fill(d.index);
						}).style("stroke", function(d) {
							return fill(d.index);
						}).attr(
								"d",
								d3.svg.arc().innerRadius(innerRadius)
										.outerRadius(outerRadius)).on(
								"mouseover", fade(.1)).on("mouseout", fade(1));

				var ticks = svg.append("g").selectAll("g").data(chord.groups)
						.enter().append("g").selectAll("g").data(groupTicks)
						.enter().append("g").attr(
								"transform",
								function(d) {
									return "rotate("
											+ (d.angle * 180 / Math.PI - 90)
											+ ")" + "translate(" + outerRadius
											+ ",0)";
								});

				ticks.append("line").attr("x1", 1).attr("y1", 0).attr("x2", 5)
						.attr("y2", 0).style("stroke", "#000");

				ticks
						.append("text")
						.attr("x", 8)
						.attr("dy", ".35em")
						.attr(
								"transform",
								function(d) {
									return d.angle > Math.PI ? "rotate(180)translate(-16)"
											: null;
								}).style("text-anchor", function(d) {
							return d.angle > Math.PI ? "end" : null;
						}).text(function(d) {
							return d.label;
						});

				svg.append("g").attr("class", "chord").selectAll("path").data(
						chord.chords).enter().append("path").attr("d",
						d3.svg.chord().radius(innerRadius)).style("fill",
						function(d) {
							return fill(d.target.index);
						}).style("opacity", 1);

				// Returns an array of tick angles and labels, given a group.
				function groupTicks(d) {
					var k = (d.endAngle - d.startAngle) / d.value;
					return d3.range(0, d.value, 25).map(function(v, i) {
						return {
							angle : v * k + d.startAngle,
							label : i % 5 ? null : v
						};
					});
				}

				// Returns an event handler for fading a given chord group.
				function fade(opacity) {
					return function(g, i) {
						svg.selectAll(".chord path").filter(function(d) {
							return d.source.index != i && d.target.index != i;
						}).transition().style("opacity", opacity);
					};
				}
			</script>

<div class="row">
	<div class="twelve columns">
			<blockquote>
				<p>
					Chord colour is important and indicates the school that getting the best of each relationship. 
				</p>
			</blockquote>
	</div>
</div>

<script src="http://d3js.org/d3.v3.min.js"></script>



<!-- FOOOTER 
================================================== -->
<div id="footer">
	<footer class="row">
	<p class="back-top floatright">
		<a href="#top"><span></span></a>
	</p>
	<div class="four columns">
		 Visualization projects
	</div>

	</footer>
</div>
<div class="copyright">
	<div class="row">
		<div class="six columns">
			 &copy;<span class="small"> Copyright 2014 Thomas Ridd</span>
		</div>
	</div>
</div>

</body>
</html>
